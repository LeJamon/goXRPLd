# Example xrpld.toml configuration file
# This is the TOML equivalent of rippled.cfg

# =============================================================================
# 1. Server Configuration
# =============================================================================

[server]
# List of port names to enable - corresponds to port sections below
ports = ["port_rpc_admin_local", "port_peer", "port_ws_admin_local"]

# Default values that apply to all ports unless overridden
port = 80
ip = "0.0.0.0"

# =============================================================================
# Port Configurations
# =============================================================================

[port_rpc_admin_local]
port = 5005
ip = "127.0.0.1"
admin = ["127.0.0.1"]
protocol = "http"

[port_peer]
# Many servers still use the legacy port of 51235, so for backward-compatibility
# we maintain that port number here. However, for new servers we recommend
# changing this to the default port of 2459.
port = 51235
ip = "0.0.0.0"
# alternatively, to accept connections on IPv4 + IPv6, use:
# ip = "::"
protocol = "peer"

[port_ws_admin_local]
port = 6006
ip = "127.0.0.1"
admin = ["127.0.0.1"]
protocol = "ws"
send_queue_limit = 500

# Uncomment to enable gRPC port for Clio integration
# [port_grpc]
# port = 50051
# ip = "127.0.0.1"
# protocol = "grpc"
# secure_gateway = ["127.0.0.1"]

# Uncomment to enable public WebSocket port
# [port_ws_public]
# port = 6005
# ip = "127.0.0.1"
# protocol = "wss"
# send_queue_limit = 500
# ssl_key = "/etc/ssl/private/server.key"
# ssl_cert = "/etc/ssl/certs/server.crt"

# =============================================================================
# 2. Peer Protocol
# =============================================================================

# Enable link compression (default: false)
compression = false

# Peer connection settings
peer_private = 0  # 0 = normal, 1 = private
peers_max = 0     # 0 = implementation default

# Maximum transactions in job queue (100-1000)
max_transactions = 250

# List of IP addresses for peer discovery
ips = [
    "r.ripple.com 51235",
    "sahyadri.isrdc.in 51235", 
    "hubs.xrpkuwait.com 51235",
    "hub.xrpl-commons.org 51235"
]

# Fixed peer connections (always maintain connections to these)
# ips_fixed = [
#     "192.168.1.100 51235",
#     "example.com 51235"
# ]

# Node seed for clustering (optional)
# node_seed = "RASH BUSH MILK LOOK BAD BRIM AVID GAFF BAIT ROT POD LOVE"

# Trusted cluster nodes (space-separated: pubkey name)
# cluster_nodes = [
#     "n9LdgEtkmGB9E2h3K4Vp7iGUaKuq23Zr32ehxiU8FWY7xoxbWTSA cluster_node_1"
# ]

[overlay]
# If server has a known public IP, specify it here
# public_ip = "203.0.113.10"

# Maximum connections per IP (0 = auto-configure)
ip_limit = 0

# Connection timeout settings (seconds)
max_unknown_time = 600   # 300-1800
max_diverged_time = 300  # 60-900

# Transaction queue settings (EXPERIMENTAL)
[transaction_queue]
ledgers_in_queue = 20
minimum_queue_size = 2000
retry_sequence_percent = 25
minimum_escalation_multiplier = 500
minimum_txn_in_ledger = 5
minimum_txn_in_ledger_standalone = 1000
target_txn_in_ledger = 50
maximum_txn_in_ledger = 0  # 0 = no maximum
normal_consensus_increase_percent = 20
slow_consensus_decrease_percent = 50
maximum_txn_per_account = 10
minimum_last_ledger_buffer = 2
zero_basefee_transaction_feelevel = 256000

# =============================================================================
# 3. Ripple Protocol
# =============================================================================

# Proposal and validation relay settings
relay_proposals = "trusted"      # all, trusted, drop_untrusted
relay_validations = "all"        # all, trusted, drop_untrusted

# Ledger history settings
ledger_history = 256             # number of ledgers or "full" or "none"
fetch_depth = "full"             # number of ledgers or "full"

# Validation settings (for validators)
# validation_seed = "RASH BUSH MILK LOOK BAD BRIM AVID GAFF BAIT ROT POD LOVE"
# validator_token = "base64-encoded-token"
# validator_key_revocation = "base64-encoded-revocation"

# Path finding aggressiveness
path_search = 2
path_search_fast = 2
path_search_max = 3
path_search_old = 2

# Default transaction fee (drops)
# fee_default = 10

# Worker thread configuration (0 = auto-detect)
workers = 0
io_workers = 0
prefetch_workers = 0

# Network identification
# network_id = "main"  # main, testnet, devnet, or integer

# Ledger replay feature
ledger_replay = 0  # 0 = disabled, 1 = enabled

# =============================================================================
# 4. HTTPS Client
# =============================================================================

# SSL certificate verification for outbound connections
ssl_verify = 1  # 0 = disabled, 1 = enabled

# SSL certificate files for verification
# ssl_verify_file = "/path/to/ca-certificates.crt"
# ssl_verify_dir = "/path/to/ca-certificates/"

# =============================================================================
# 6. Database
# =============================================================================

[node_db]
# Database type: NuDB (recommended for SSDs) or RocksDB
type = "NuDB"
path = "/var/lib/xrpld/db/nudb"

# Online deletion of old ledgers
online_delete = 512
advisory_delete = 0

# Cache settings
cache_size = 16384  # 0 = default
cache_age = 5       # minutes

# Performance settings
fast_load = false

# Network-specific settings
earliest_seq = 32570  # XRP Ledger default

# Online delete tuning
delete_batch = 100
back_off_milliseconds = 100
age_threshold_seconds = 60
recovery_wait_seconds = 5

# Optional import database configuration
# [import_db]
# type = "NuDB"
# path = "/path/to/import/db"

# SQLite database path
database_path = "/var/lib/xrpld/db"

[sqlite]
# Safety level: "high" (default) or "low"
# safety_level = "high"

# Individual settings (cannot be combined with safety_level)
journal_mode = "wal"        # delete, truncate, persist, memory, wal, off
synchronous = "normal"      # off, normal, full, extra
temp_store = "file"         # default, file, memory
page_size = 4096           # power of 2 between 512-65536
journal_size_limit = 1582080

# =============================================================================
# 7. Diagnostics
# =============================================================================

# Debug log file location
debug_logfile = "/var/log/xrpld/debug.log"

# Beast.Insight stats collection
[insight]
# server = "statsd"
# address = "127.0.0.1:8125"
# prefix = "xrpld_node"

# Performance logging
[perf]
# perf_log = "/var/log/xrpld/perf.log"
# log_interval = 1

# =============================================================================
# 8. Voting
# =============================================================================

[voting]
# Fee voting (in drops) - leave empty to use internal defaults
# reference_fee = 10        # 10 drops
# account_reserve = 10000000  # 10 XRP
# owner_reserve = 2000000     # 2 XRP

# =============================================================================
# 9. Misc Settings
# =============================================================================

# Node size tuning: tiny, small, medium, large, huge (empty = auto-detect)
node_size = ""

# Allow remote signing commands (discouraged for security)
signing_support = false

# Crawler endpoint configuration
[crawl]
enabled = true
overlay = 1  # Report peer overlay info
server = 1   # Report server state info  
counts = 0   # Report health counters
unl = 1      # Report validator lists

# Validator list endpoint
[vl]
enable = 1

# Beta API features
beta_rpc_api = 0

# WebSocket ping frequency (seconds, 0 = default)
websocket_ping_frequency = 0

# Server domain for TOML file discovery
# server_domain = "example.com"

# =============================================================================
# Special Configurations
# =============================================================================

# RPC commands to run at startup
rpc_startup = [
    { command = "log_level", severity = "warning" }
]

# Validators file location (relative to config directory)
validators_file = "validators.toml"